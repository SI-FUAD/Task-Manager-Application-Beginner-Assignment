<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Assignment</title>
    <style>
        body {
            background-color: rgba(175, 140, 207, 0.299);
        }

        h1 {
            margin: 30px;
            padding: 20px;
            background-color: blueviolet;
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            color: antiquewhite;
            display: flex;
            justify-content: center;
            box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
        }

        #add {
            margin: 20px;
            padding: 30px;
            display: flex;
            justify-content: center;
        }

        #submit_button {
            margin-left: 50px;
            border-radius: 20px;
            padding: 0px 50px;
            background-color: rgb(165, 165, 183);
            cursor: pointer;
        }

        #submit_button:hover {
            background-color: rgb(122, 122, 181);
        }

        #inputTitle, #inputDescription, #priority {
            margin: 20px;
            padding: 20px;
        }

        #inputEditorDelete {
            padding: 20px;
            width: 240px;
        }

        #edit, #delete {
            width: 100px;
            height: 40px;
            background-color: rgb(164, 192, 182);
            cursor: pointer;
        }

        #edit:hover, #delete:hover {
            background-color: rgb(120, 147, 137);
        }

        #addError {
            color: red;
            display: flex;
            justify-content: center;
        }

        #addSuccess {
            color: green;
            display: flex;
            justify-content: center;
        }

        #showCards {
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            background-color: rgb(168, 168, 218);
            border-radius: 50px;
            margin: 20px;
            padding: 30px;
            display: flex;
            flex-wrap: wrap;
            box-shadow: rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset;
        }

        footer {
            padding: 20px;
            background-color: rgb(55, 47, 63);
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            color: bisque;
            display: flex;
            justify-content: center;
        }
    </style>
</head>
<body>
    <header>
        <h1>Task Manager Application</h1>
    </header>
    <main>
        <p id="date" style="margin-left: 20px;">Wait 1 sec...</p>
        <div id="add">
        <input type="text" placeholder="Add a new task title" id="inputTitle" maxlength="40"><br><br>
        <input type="text" placeholder="Add a new task desciption" id="inputDescription" maxlength="120" required><br><br>
        <select name="priority" id="priority">
            <option value="Low">Low</option>
            <option value="Medium">Medium</option>
            <option value="High">High</option>
        </select>
        <button id="submit_button">Submit</button>
    </div>
    <p id="addSuccess"></p>
    <p id="addError"></p>
    <div>
        <input type="text" placeholder="Add a task title to edit or delete" id="inputEditorDelete" maxlength="40" required><br><br>
        <button id="edit">Edit</button>
        <button id="delete">Delete</button>
    </div>
    <div id="editField"></div>
    <p id="editordeleteError" style="color: red;"></p>
    <div id="showCards">No Tasks Added Yet!</div>
    </main>
    <footer>Task Managing Application. All rights reserved.</footer>
    <script>
        function load() {
            const dt = localStorage.getItem("Task Manager Application");
             let data = JSON.parse(dt);
             if (data === null) {
                data = [];
             }
             return data;
        }

        function save(s) {
            const st = JSON.stringify(s);
            localStorage.setItem("Task Manager Application", st);
        }

        function addTask() {
            const inputTitle = document.getElementById("inputTitle");
            const inputDescription = document.getElementById("inputDescription");
            const inputPriority = document.getElementById("priority");
            let obj = {};
            let r;
            if (z) {
            if (inputTitle.value !== "" && inputDescription.value !== "") {
                if (allId.length !== 0) {
                    for (const t of allId) {
                    if (t.title === inputTitle.value) {
                        r = "Reject";
                        break;
                    } else {
                        r = "Accept";
                    }
                }
            } else {
                r = "Accept";
            }
            } else {
                r = "";
            }
            if (r === "Accept") {
                obj = {
                    title : inputTitle.value,
                    description : inputDescription.value,
                    priority : inputPriority.value
                };
                allId.push(obj);
                save(allId);
                document.getElementById("addError").innerHTML = "";
                document.getElementById("editordeleteError").innerHTML = "";
                document.getElementById("addSuccess").innerHTML = "Successfully Added!";
                inputTitle.value = "";
                inputDescription.value = "";
                inputPriority.value = "Low";
                display();
            } else if (r === "Reject") {
                document.getElementById("addSuccess").innerHTML = "";
                document.getElementById("editordeleteError").innerHTML = "";
                document.getElementById("addError").innerHTML = "Title must be unique!";
            } else if (r === "") {
                document.getElementById("addSuccess").innerHTML = "";
                document.getElementById("editordeleteError").innerHTML = "";
                document.getElementById("addError").innerHTML = "Title and Description needed!";
            }
        } else {
            r = "Not Found";
            for (const o of allId) {
                if (o.title === inputTitle.value) {
                    o.title = inputTitle.value;
                    o.description = inputDescription.value;
                    o.priority = inputPriority.value;
                    r = "Found";
                    save(allId);
                    document.getElementById("editordeleteError").innerHTML = ""
                    document.getElementById("addError").innerHTML = "";
                    document.getElementById("addSuccess").innerHTML = "Successfully Edited!"
                    inputTitle.value = "";
                    inputDescription.value = "";
                    inputPriority.value = "Low";
                    document.getElementById("submit_button").innerHTML = "Submit";
                    z = true;
                    inputTitle.disabled = false;
                    const dl = document.getElementById("delete");
                    dl.disabled = false;
                    display();
                }
            }
            if (r === "Not Found") {
                document.getElementById("addError").innerHTML = "";
                document.getElementById("addSuccess").innerHTML = "";
                document.getElementById("editordeleteError").innerHTML = "The title is missing!";
            }
        }
    }

        function editTask() {
            const ed = document.getElementById("inputEditorDelete");
            let r = false;
            for (const q of allId) {
                if (q.title === ed.value) {
                    const inputTitle = document.getElementById("inputTitle");
                    const inputDescription = document.getElementById("inputDescription");
                    const inputPriority = document.getElementById("priority");
                    const editButton = document.getElementById("submit_button");
                    inputTitle.value = q.title;
                    inputTitle.disabled = true;
                    const dl = document.getElementById("delete");
                    dl.disabled = true;
                    inputDescription.value = q.description;
                    inputPriority.value = q.priority;
                    editButton.innerHTML = "Confirm";
                    z = false;
                    r = true;
                    const dr = document.getElementById("inputEditorDelete");
                    dr.value = "";
                    document.getElementById("addSuccess").innerHTML = "The task is selected to edit!";
                    document.getElementById("addError").innerHTML = "";
                    document.getElementById("editordeleteError").innerHTML = "";
                }
            }
            if (!r) {
                document.getElementById("addError").innerHTML = "";
                document.getElementById("addSuccess").innerHTML = "";
                document.getElementById("editordeleteError").innerHTML = "Title not found to edit!";
            }
        }

        function deleteTask() {
            let b = false;
            let arr = [];
            let obj2 = {};
            const del = document.getElementById("inputEditorDelete");
            for (const p of allId) {
                if (p.title !== del.value) {
                    obj2 = {
                    title : p.title,
                    description : p.description,
                    priority : p.priority
                };
                arr.push(obj2);
                } else {
                    b = true;
            }
        }
            if (b) {
                save(arr);
                document.getElementById("addError").innerHTML = "";
                document.getElementById("addSuccess").innerHTML = "Successfully Deleted!";
                document.getElementById("editordeleteError").innerHTML = "";
                document.getElementById("submit_button").innerHTML = "Submit";
                z = true;
                const dz = document.getElementById("inputEditorDelete");
                dz.value = "";
                allId = load();
                display();
            } else {
                document.getElementById("addError").innerHTML = "";
                document.getElementById("addSuccess").innerHTML = "";
                document.getElementById("editordeleteError").innerHTML = "Title not found to delete!";
            }
        }

        function display() {
            const w = document.getElementById("showCards");
            if (allId.length !== 0) {
                w.innerHTML = "";
                for (const task of allId) {
                    const temp = document.createElement("div");
                    w.appendChild(temp);
                    temp.style.overflowWrap = "break-word";
                    temp.style.margin = "20px";
                    temp.style.padding = "50px";
                    temp.style.width = "200px";
                    temp.style.height = "200px";
                    temp.style.borderRadius = "50px";
                    temp.style.boxShadow = "rgba(0, 0, 0, 0.3) 0px 19px 38px, rgba(0, 0, 0, 0.22) 0px 15px 12px";
                    if (task.priority === "High") {
                        temp.style.backgroundColor = "rgb(242, 94, 65)";
                    } else if (task.priority === "Medium") {
                        temp.style.backgroundColor = "rgb(240, 172, 55)";
                    } else {
                        temp.style.backgroundColor = "rgb(240, 236, 58)";
                    }
                    temp.innerHTML = "Title: " + task.title + "<br>Description: " + task.description + "<br>Priority: <b>" + task.priority + "</b>";
                }
            } else {
                w.innerHTML = "No Tasks Added Yet!";
            }
        }
        
        let allId;
        let z;
        allId = load();
        z = true;
        const h = document.getElementById("submit_button");
        h.addEventListener("click", addTask);
        const v = document.getElementById("edit");
        v.addEventListener("click", editTask);
        const k = document.getElementById("delete");
        k.addEventListener("click", deleteTask);
        setInterval(function() {
            const d = new Date();
            document.getElementById("date").innerHTML = d.toLocaleTimeString();
        }, 1000);
        display();
    </script>
</body>
</html>
